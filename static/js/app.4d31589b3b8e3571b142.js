webpackJsonp([2,0],[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var i=n(43),o=a(i),l=n(115),s=a(l),u=n(120),r=a(u),d=n(46),c=a(d);n(107),n(90),n(96),o["default"].use(r["default"]),new o["default"]({store:c["default"],el:"body",components:{App:s["default"]},data:{}})},,,,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(52),o=a(i),l=n(27),s=a(l),u=n(28),r=a(u),d=n(29),c=a(d),f=n(45),p=a(f),m=function(){function e(){(0,r["default"])(this,e),console.log("CONSTRUCTING GApi!!!!"),this.CLIENT_ID="82194900104-fpkii8sk6vg12ihm0sf8v8c165bictn0.apps.googleusercontent.com",this.SCOPES=["email","profile","https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.install","https://www.googleapis.com/auth/plus.login"],this.DEFAULT_FIELDS="capabilities(canCopy,canEdit),createdTime,fileExtension,id,mimeType,modifiedTime,name,shared,size,version"}return(0,c["default"])(e,[{key:"loadDriveApis",value:function(){return new s["default"](function(e,t){!function n(){console.log("loadDriveApi..."),gapi&&gapi.client?s["default"].all([gapi.client.load("drive","v3"),gapi.client.load("plus","v1"),gapi.load("picker"),gapi.load("drive-share")]).then(function(){console.log("gapi.client.load finished!!"),e()}):(setTimeout(function(){return n()},10),console.log("wait for it..."))}()})}},{key:"authorize",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0],n=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return console.log("authorize"),new s["default"](function(a,i){gapi.auth.authorize(e.buildAuthRequest(t,n),function(e){e&&!e.error?(console.log("resolved!"),a()):(console.log("rejected!"),i())})})}},{key:"buildAuthRequest",value:function(e,t){var n={client_id:this.CLIENT_ID,scope:this.SCOPES.join(" "),immediate:e};return t&&(n.login_hint=t,n.authuser=-1),n}},{key:"getUserProfile",value:function(){return gapi.client.plus.people.get({userId:"me"})}},{key:"saveXgzFile",value:function(e,t){var n,a;e.metadata.id?(n="/upload/drive/v3/files/"+encodeURIComponent(e.metadata.id),a="PATCH"):(n="/upload/drive/v3/files",a="POST");var i={mimeType:e.metadata.mimeType,name:t||e.metadata.name},l=(new p["default"]).append("application/json",(0,o["default"])(i)).append(e.metadata.mimeType,e.content).finish();return gapi.client.request({path:n,method:a,params:{uploadType:"multipart",fields:this.DEFAULT_FIELDS},headers:{"Content-Type":l.type},body:l.body})}},{key:"combineAndStoreResults",value:function(e,t){var n={metadata:e,content:t};return n}},{key:"loadFile",value:function(e){var t=this;return new s["default"](function(n,a){var i=gapi.client.drive.files.get({fileId:e,fields:t.DEFAULT_FIELDS}),o=gapi.client.drive.files.get({fileId:e,alt:"media"});n(s["default"].all([i,o]))}).then(function(e){return{metadata:e[0].result,content:e[1].body}})}},{key:"showPicker",value:function(){return new s["default"](function(e,t){var n=new google.picker.DocsView(google.picker.ViewId.DOCS);n.setMimeTypes("application/file-xgz"),n.setSelectFolderEnabled(!0),n.setIncludeFolders(!0);var a=(new google.picker.PickerBuilder).setAppId("82194900104").setOAuthToken(gapi.auth.getToken().access_token).addView(n).setCallback(function(n){if("picked"===n.action){var a=n.docs[0].id;e(a)}else"cancel"===n.action&&t()}).build();a.setVisible(!0)})}},{key:"showSharing",value:function(e){var t=new gapi.drive.share.ShareClient("82194900104");t.setOAuthToken(gapi.auth.getToken().access_token),t.setItemIds([e]),t.showSettingsDialog()}}]),e}();t["default"]=new m},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadFile=t.renameFile=t.editContent=t.saveXGZ=t.createNewXGZ=void 0;var o=n(27),l=i(o),s=n(9),u=i(s),r=n(25),d=a(r),c=n(42),f=i(c),p=(t.createNewXGZ=function(e,t){var n=e.dispatch,a=e.state;console.log("Creating new XGZ"),n(d.NEW_FILE),u["default"].saveXgzFile(a.xgzfile,t).then(function(e){return n(d.FILE_SAVED,e.result)},function(e){return n(d.FILE_NOT_SAVED)})},t.saveXGZ=function(e){var t=e.dispatch,n=e.state;return console.log("Saving new XGZ"),t(d.FILE_SAVING),new l["default"](function(e,a){u["default"].saveXgzFile(n.xgzfile).then(function(n){t(d.FILE_SAVED,n.result),e()},function(e){t(d.FILE_NOT_SAVED),a(e)})})}),m=f["default"].debounce(p,5e3);t.editContent=function(e,t){var n=e.dispatch,a=e.state;console.log("Editing XGZ content: "+t.target.value),n(d.EDIT_CONTENT,t.target.value),m({dispatch:n,state:a})},t.renameFile=function(e,t){var n=e.dispatch,a=e.state;console.log("renaming XGZ"),n(d.RENAME_FILE,t),m({dispatch:n,state:a})},t.loadFile=function(e,t){var n=e.dispatch;n(d.LOAD_FILE,t),window.history.pushState(void 0,"","?file="+t.metadata.id)}},,,,,,,,,,,,,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={state:{name:"",image:"",email:""},setUser:function(e){this.state.name=e.name,this.state.image=e.image,this.state.email=e.email}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_LIST=void 0;var i,o=n(53),l=a(o),s=n(42),u=a(s),r=n(25),d=t.STATUS_LIST={INITIAL:"INTIAL",SAVING:"SAVING",SAVED:"SAVED",NOT_SAVED:"NOT_SAVED",DIRTY:"DIRTY"},c={metadata:{name:"New XGZ document"},content:"",status:d.INITIAL},f=(i={},(0,l["default"])(i,r.NEW_FILE,function(e,t){e.metadata={id:null,mimeType:"application/file-xgz",name:t},e.content=""}),(0,l["default"])(i,r.FILE_SAVED,function(e,t){u["default"].assign(e.metadata,t),e.status=d.SAVED}),(0,l["default"])(i,r.FILE_NOT_SAVED,function(e){e.status=d.NOT_SAVED}),(0,l["default"])(i,r.FILE_SAVING,function(e){e.status=d.SAVING}),(0,l["default"])(i,r.EDIT_CONTENT,function(e,t){e.content=t,e.status=d.DIRTY}),(0,l["default"])(i,r.RENAME_FILE,function(e,t){e.metadata.name=t,e.status=d.DIRTY}),(0,l["default"])(i,r.LOAD_FILE,function(e,t){e.metadata=t.metadata,e.content=t.content,e.status=e.status=d.SAVED}),i);t["default"]={state:c,mutations:f}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NEW_FILE="NEW_FILE",t.FILE_SAVED="FILE_SAVED",t.FILE_SAVING="FILE_SAVING",t.FILE_NOT_SAVED="FILE_NOT_SAVED",t.EDIT_CONTENT="EDIT_CONTENT",t.RENAME_FILE="RENAME_FILE",t.LOAD_FILE="LOAD_FILE"},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),o=a(i),l=n(29),s=a(l),u=function(){function e(){(0,o["default"])(this,e),this.boundary=Math.random().toString(36).slice(2),this.mimeType='multipart/mixed; boundary="'+this.boundary+'"',this.parts=[],this.body=null}return(0,s["default"])(e,[{key:"append",value:function(e,t){if(null!==this.body)throw new Error("Builder has already been finalized.");return this.parts.push("\r\n--",this.boundary,"\r\n","Content-Type: ",e,"\r\n\r\n",t),this}},{key:"finish",value:function(){if(0===this.parts.length)throw new Error("No parts have been added.");return null===this.body&&(this.parts.push("\r\n--",this.boundary,"--"),this.body=this.parts.join("")),{type:this.mimeType,body:this.body}}}]),e}();t["default"]=u},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(43),o=a(i),l=n(121),s=a(l),u=n(24),r=a(u);o["default"].use(s["default"]),console.log("USED VUEEEEEEEEEXXXX"),o["default"].config.debug=!0;var d=!1;t["default"]=new s["default"].Store({modules:{xgzfile:r["default"]},strict:d})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(108),o=a(i),l=n(10),s=n(118),u=a(s),r=n(116),d=a(r),c=n(117),f=a(c),p=n(9),m=a(p),v=n(23),g=a(v);t["default"]={components:{PageHeader:u["default"],TextView:f["default"],"create-new-xgz-dialog":d["default"]},data:function(){return{user:null,file:null}},vuex:{actions:{loadFile:l.loadFile}},attached:function(){var e=this;console.log(m["default"]);var t=o["default"].parse(window.location.search);console.log(t),this.user=t.user,this.file=t.file,m["default"].loadDriveApis().then(function(){console.log("starting authorize"),m["default"].authorize(!0,e.user).then(function(){e.loadUserData(),e.loadThisFile()})["catch"](function(t){console.log("error inload or authorize"),e.$refs.login.open()})})},methods:{handleAuthClick:function(){var e=this;this.$refs.login.close(),m["default"].authorize(!1,this.user).then(function(){e.loadUserData(),e.loadThisFile()})},loadUserData:function(){console.log("load userData"),m["default"].getUserProfile().then(function(e){console.log(e),g["default"].setUser({name:e.result.displayName,image:e.result.image.url,email:e.result.emails[0].value})})},loadThisFile:function(){var e=this;console.log("load file"),this.file?m["default"].loadFile(this.file).then(function(t){console.log("GOT FILE!!!!!!"),e.loadFile(t)}):this.openCreateNewXGZ()},openCreateNewXGZ:function(){this.$refs.create_new.openDialog()}}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),o=n(109),l=a(o),s=n(9),u=a(s);t["default"]={data:function(){return{filename:"New XGZ document",gdriveSvg:l["default"]}},vuex:{actions:{createNewXGZ:i.createNewXGZ,loadFile:i.loadFile}},methods:{openDialog:function(){this.filename="New XGZ document",this.$refs.create_new_xgz.open()},createNew:function(){this.$refs.create_new_xgz.close(),this.createNewXGZ(this.filename)},openFromGDrive:function(){var e=this;this.$refs.create_new_xgz.close(),u["default"].showPicker().then(function(t){console.log("open file:"+t),t!==e.fileId&&u["default"].loadFile(t).then(function(t){console.log("GOT FILE!!!!!!"),e.loadFile(t)})})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10);t["default"]={vuex:{getters:{fileContent:function(e){return e.xgzfile.content}},actions:{editContent:a.editContent}}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(100),o=a(i),l=n(44),s=a(l),u=n(119),r=a(u),d=n(10),c=n(24),f=n(9),p=a(f);t["default"]={components:{ProfileMenu:r["default"]},data:function(){return{}},watch:{fileName:function(e,t){"undefined"!=typeof this&&this.$els.filename.dispatchEvent(new Event("input"))}},vuex:{getters:{fileStatus:function(e){switch(console.log(e.xgzfile.status),console.log(c.STATUS_LIST.SAVED),e.xgzfile.status){case c.STATUS_LIST.INTIAL:return"New file";case c.STATUS_LIST.SAVING:return"Saving...";case c.STATUS_LIST.SAVED:return"Last change on "+e.xgzfile.metadata.modifiedTime;case c.STATUS_LIST.NOT_SAVED:return"Could not save to drive";case c.STATUS_LIST.DIRTY:return"Not saved"}},fileName:function(e){return e.xgzfile.metadata.name},fileId:function(e){return e.xgzfile.metadata.id}},actions:{renameFile:d.renameFile,loadFile:d.loadFile}},methods:{rename:function(e){this.renameFile(e.target.value)},openCreateNewXGZ:function(){window.open("/","_blank"),this.closeNav()},closeNav:function(){setTimeout(function(){var e=document.querySelector(".mdl-layout__drawer");(0,o["default"])(e.classList,"is-visible")!==-1&&document.querySelector(".mdl-layout").MaterialLayout.toggleDrawer()},100)},openFile:function(){var e=this;p["default"].showPicker().then(function(t){console.log("open file:"+t),t!==e.fileId&&p["default"].loadFile(t).then(function(t){console.log("GOT FILE!!!!!!"),e.loadFile(t)})}),this.closeNav()},openShare:function(){p["default"].showSharing(this.fileId),this.closeNav()}},ready:function(){(0,s["default"])(this.$els.filename)}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),o=a(i);t["default"]={data:function(){return{user:o["default"].state}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,,,function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHZlcnNpb249IjEuMSIgIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgPHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTcuNzEsMy41TDEuMTUsMTVMNC41OCwyMUwxMS4xMyw5LjVNOS43MywxNUw2LjMsMjFIMTkuNDJMMjIuODUsMTVNMjIuMjgsMTRMMTUuNDIsMkg4LjU4TDguNTcsMkwxNS40MywxNEgyMi4yOFoiIC8+Cjwvc3ZnPg=="},function(e,t){e.exports=' <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header"> <page-header></page-header> <main class="mdl-layout__content mdl-color--grey-100"> <div class=page-content> <div class=mdl-grid> <div class="mdl-cell mdl-cell--2-col" id=left-tools> </div> <div class="mdl-cell mdl-cell--8-col" id=text-view> <text-view></text-view> </div> <div class="mdl-cell mdl-cell--2-col" id=right-tools> </div> </div> <mdl-dialog v-ref:login full-width title="Hi there"> <p>Please log in with your Google Drive account</p> <template slot=actions> <mdl-button primary @click=handleAuthClick>Login</mdl-button> </template> </mdl-dialog> <pre id=output></pre> </div> </main> <create-new-xgz-dialog v-ref:create_new></create-new-xgz-dialog> </div> '},function(e,t){e.exports=' <header class="mdl-layout__header mdl-color--grey-100 mdl-color-text--grey-600"> <div class=mdl-layout__header-row> <i class=material-icons>short_text</i> <input class=filename contenteditable=true @blur=rename :value=fileName v-el:filename/> <span class=filestatus>{{ fileStatus }}</span> <div class=mdl-layout-spacer></div> <nav class="mdl-navigation mdl-layout--large-screen-only"> <mdl-button @click=openShare><i class=material-icons>share</i> Share</mdl-button> </nav> </div> </header> <div class=mdl-layout__drawer> <span class=mdl-layout-title> </span> <nav class=mdl-navigation> <profile-menu></profile-menu> <a class=mdl-navigation__link @click=openCreateNewXGZ>New</a> <a class=mdl-navigation__link @click=openFile>Open</a> <a class=mdl-navigation__link @click=openShare>Share</a> </nav> </div> '},function(e,t){e.exports=' <mdl-dialog v-ref:create_new_xgz="" full-width="" title="Create new XGZ" _v-09d6ba0a=""> <mdl-textfield floating-label="File name" :value.sync=filename _v-09d6ba0a=""></mdl-textfield> <template slot=actions> <mdl-button primary="" @click=createNew() _v-09d6ba0a="">Create</mdl-button> <mdl-button @click=openFromGDrive() _v-09d6ba0a="">... or open from Google Drive <img v-bind:src=gdriveSvg _v-09d6ba0a=""></mdl-button> </template> </mdl-dialog> '},function(e,t){e.exports=' <div class=demo-avatar-dropdown _v-49020613=""> <img class=avatar v-bind:src=user.image _v-49020613=""> <span _v-49020613="">{{ user.email }}</span> <button id=accbtn class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" _v-49020613=""> <i class=material-icons role=presentation _v-49020613="">arrow_drop_down</i> <span class=visuallyhidden _v-49020613="">Accounts</span> </button> <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for=accbtn _v-49020613=""> <li class=mdl-menu__item _v-49020613="">logout</li> </ul> </div> '},function(e,t){e.exports=' <textarea :value=fileContent @input=editContent _v-c3206866=""></textarea> '},function(e,t,n){var a,i;n(91),a=n(47),i=n(110),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var a,i;n(93),a=n(48),i=n(112),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var a,i;n(95),a=n(49),i=n(114),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var a,i;n(92),a=n(50),i=n(111),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var a,i;n(94),a=n(51),i=n(113),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)}]);
//# sourceMappingURL=app.4d31589b3b8e3571b142.js.map